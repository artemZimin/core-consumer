// Code generated by gorm.io/gen. DO NOT EDIT.
// Code generated by gorm.io/gen. DO NOT EDIT.
// Code generated by gorm.io/gen. DO NOT EDIT.

package query

import (
	"context"
	"database/sql"

	"gorm.io/gorm"

	"gorm.io/gen"

	"gorm.io/plugin/dbresolver"
)

func Use(db *gorm.DB, opts ...gen.DOOption) *Query {
	return &Query{
		db:                           db,
		Cache:                        newCache(db, opts...),
		CacheLock:                    newCacheLock(db, opts...),
		FailedJob:                    newFailedJob(db, opts...),
		Job:                          newJob(db, opts...),
		JobBatch:                     newJobBatch(db, opts...),
		Migration:                    newMigration(db, opts...),
		PasswordResetToken:           newPasswordResetToken(db, opts...),
		Proxy:                        newProxy(db, opts...),
		Session:                      newSession(db, opts...),
		TelegramBotUser:              newTelegramBotUser(db, opts...),
		User:                         newUser(db, opts...),
		UserAgent:                    newUserAgent(db, opts...),
		WbCatalogNotification:        newWbCatalogNotification(db, opts...),
		WbCatalogNotificationLog:     newWbCatalogNotificationLog(db, opts...),
		WbCatalogNotificationProduct: newWbCatalogNotificationProduct(db, opts...),
		WbCatalogNotificationProxy:   newWbCatalogNotificationProxy(db, opts...),
		WbProductPrice:               newWbProductPrice(db, opts...),
		WbStockNotification:          newWbStockNotification(db, opts...),
	}
}

type Query struct {
	db *gorm.DB

	Cache                        cache
	CacheLock                    cacheLock
	FailedJob                    failedJob
	Job                          job
	JobBatch                     jobBatch
	Migration                    migration
	PasswordResetToken           passwordResetToken
	Proxy                        proxy
	Session                      session
	TelegramBotUser              telegramBotUser
	User                         user
	UserAgent                    userAgent
	WbCatalogNotification        wbCatalogNotification
	WbCatalogNotificationLog     wbCatalogNotificationLog
	WbCatalogNotificationProduct wbCatalogNotificationProduct
	WbCatalogNotificationProxy   wbCatalogNotificationProxy
	WbProductPrice               wbProductPrice
	WbStockNotification          wbStockNotification
}

func (q *Query) Available() bool { return q.db != nil }

func (q *Query) clone(db *gorm.DB) *Query {
	return &Query{
		db:                           db,
		Cache:                        q.Cache.clone(db),
		CacheLock:                    q.CacheLock.clone(db),
		FailedJob:                    q.FailedJob.clone(db),
		Job:                          q.Job.clone(db),
		JobBatch:                     q.JobBatch.clone(db),
		Migration:                    q.Migration.clone(db),
		PasswordResetToken:           q.PasswordResetToken.clone(db),
		Proxy:                        q.Proxy.clone(db),
		Session:                      q.Session.clone(db),
		TelegramBotUser:              q.TelegramBotUser.clone(db),
		User:                         q.User.clone(db),
		UserAgent:                    q.UserAgent.clone(db),
		WbCatalogNotification:        q.WbCatalogNotification.clone(db),
		WbCatalogNotificationLog:     q.WbCatalogNotificationLog.clone(db),
		WbCatalogNotificationProduct: q.WbCatalogNotificationProduct.clone(db),
		WbCatalogNotificationProxy:   q.WbCatalogNotificationProxy.clone(db),
		WbProductPrice:               q.WbProductPrice.clone(db),
		WbStockNotification:          q.WbStockNotification.clone(db),
	}
}

func (q *Query) ReadDB() *Query {
	return q.ReplaceDB(q.db.Clauses(dbresolver.Read))
}

func (q *Query) WriteDB() *Query {
	return q.ReplaceDB(q.db.Clauses(dbresolver.Write))
}

func (q *Query) ReplaceDB(db *gorm.DB) *Query {
	return &Query{
		db:                           db,
		Cache:                        q.Cache.replaceDB(db),
		CacheLock:                    q.CacheLock.replaceDB(db),
		FailedJob:                    q.FailedJob.replaceDB(db),
		Job:                          q.Job.replaceDB(db),
		JobBatch:                     q.JobBatch.replaceDB(db),
		Migration:                    q.Migration.replaceDB(db),
		PasswordResetToken:           q.PasswordResetToken.replaceDB(db),
		Proxy:                        q.Proxy.replaceDB(db),
		Session:                      q.Session.replaceDB(db),
		TelegramBotUser:              q.TelegramBotUser.replaceDB(db),
		User:                         q.User.replaceDB(db),
		UserAgent:                    q.UserAgent.replaceDB(db),
		WbCatalogNotification:        q.WbCatalogNotification.replaceDB(db),
		WbCatalogNotificationLog:     q.WbCatalogNotificationLog.replaceDB(db),
		WbCatalogNotificationProduct: q.WbCatalogNotificationProduct.replaceDB(db),
		WbCatalogNotificationProxy:   q.WbCatalogNotificationProxy.replaceDB(db),
		WbProductPrice:               q.WbProductPrice.replaceDB(db),
		WbStockNotification:          q.WbStockNotification.replaceDB(db),
	}
}

type queryCtx struct {
	Cache                        *cacheDo
	CacheLock                    *cacheLockDo
	FailedJob                    *failedJobDo
	Job                          *jobDo
	JobBatch                     *jobBatchDo
	Migration                    *migrationDo
	PasswordResetToken           *passwordResetTokenDo
	Proxy                        *proxyDo
	Session                      *sessionDo
	TelegramBotUser              *telegramBotUserDo
	User                         *userDo
	UserAgent                    *userAgentDo
	WbCatalogNotification        *wbCatalogNotificationDo
	WbCatalogNotificationLog     *wbCatalogNotificationLogDo
	WbCatalogNotificationProduct *wbCatalogNotificationProductDo
	WbCatalogNotificationProxy   *wbCatalogNotificationProxyDo
	WbProductPrice               *wbProductPriceDo
	WbStockNotification          *wbStockNotificationDo
}

func (q *Query) WithContext(ctx context.Context) *queryCtx {
	return &queryCtx{
		Cache:                        q.Cache.WithContext(ctx),
		CacheLock:                    q.CacheLock.WithContext(ctx),
		FailedJob:                    q.FailedJob.WithContext(ctx),
		Job:                          q.Job.WithContext(ctx),
		JobBatch:                     q.JobBatch.WithContext(ctx),
		Migration:                    q.Migration.WithContext(ctx),
		PasswordResetToken:           q.PasswordResetToken.WithContext(ctx),
		Proxy:                        q.Proxy.WithContext(ctx),
		Session:                      q.Session.WithContext(ctx),
		TelegramBotUser:              q.TelegramBotUser.WithContext(ctx),
		User:                         q.User.WithContext(ctx),
		UserAgent:                    q.UserAgent.WithContext(ctx),
		WbCatalogNotification:        q.WbCatalogNotification.WithContext(ctx),
		WbCatalogNotificationLog:     q.WbCatalogNotificationLog.WithContext(ctx),
		WbCatalogNotificationProduct: q.WbCatalogNotificationProduct.WithContext(ctx),
		WbCatalogNotificationProxy:   q.WbCatalogNotificationProxy.WithContext(ctx),
		WbProductPrice:               q.WbProductPrice.WithContext(ctx),
		WbStockNotification:          q.WbStockNotification.WithContext(ctx),
	}
}

func (q *Query) Transaction(fc func(tx *Query) error, opts ...*sql.TxOptions) error {
	return q.db.Transaction(func(tx *gorm.DB) error { return fc(q.clone(tx)) }, opts...)
}

func (q *Query) Begin(opts ...*sql.TxOptions) *QueryTx {
	tx := q.db.Begin(opts...)
	return &QueryTx{Query: q.clone(tx), Error: tx.Error}
}

type QueryTx struct {
	*Query
	Error error
}

func (q *QueryTx) Commit() error {
	return q.db.Commit().Error
}

func (q *QueryTx) Rollback() error {
	return q.db.Rollback().Error
}

func (q *QueryTx) SavePoint(name string) error {
	return q.db.SavePoint(name).Error
}

func (q *QueryTx) RollbackTo(name string) error {
	return q.db.RollbackTo(name).Error
}
